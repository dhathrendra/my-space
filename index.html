<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://fonts.googleapis.com/css2?family=Wallpoet&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
    />
    <title>My Space</title>
    <link
      rel="icon"
      href="https://api.iconify.design/fluent-emoji-flat/brain.svg"
      type="image/svg+xml"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Black+Ops+One&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
  </head>
  <body>
    <header class="site-header">
      <div class="header-inner">
        <div class="logo-group">
          <img src="pfp.jpg" alt="Dhath" class="header-pfp" />
          <h1 class="logo">Dhathrendra<span class="cursor">|</span></h1>
        </div>

        <nav class="header-nav desktop-nav">
          <a href="#about">About</a>
          <a href="#journey">Journey So Far</a>
          <a href="#contact">Contact Me</a>
        </nav>

        <button class="hamburger" aria-label="Menu">
          <span></span>
          <span></span>
          <span></span>
        </button>

        <nav class="mobile-menu">
          <a href="#about">About</a>
          <a href="#journey">Journey So Far</a>
          <a href="#contact">Contact Me</a>
        </nav>
      </div>
    </header>

    <section id="home" class="first-page">
      <div class="hero-text">
        <h1 class="tagline-big">Built with Curiosity</h1>
        <h2 class="tagline-small">driven by intent</h2>
      </div>
      <div class="scroll-container">
        <a href="#about" class="scroll-btn">
          Get Started…
          <i class="fas fa-arrow-down"></i>
        </a>
      </div>
    </section>

    <section id="about" class="second-page">
      <div class="about-container">
        <h2 class="about-title">About Me</h2>
        <div class="divider"></div>
        <div class="about-text" id="about-text">Loading...</div>
      </div>
    </section>

    <section id="journey" class="journey-page">
      <h2 class="path-title">Path and Progress</h2>
      <div class="timeline-container" id="timeline-container">
        Loading experiences...
      </div>
    </section>

    <section id="contact" class="contact-page">
      <h2 class="section-title">Contact Me</h2>

      <div class="contact-grid">
        <a
          href="mailto:k.dhathrendra@gmail.com"
          class="contact-card"
          target="_blank"
        >
          <div class="icon-wrapper"><i class="fas fa-envelope"></i></div>
          <span class="contact-label">Email</span>
          <span class="contact-value">k.dhathrendra@gmail.com</span>
        </a>

        <a
          href="https://instagram.com/dhathrendra08"
          class="contact-card"
          target="_blank"
        >
          <div class="icon-wrapper"><i class="fab fa-instagram"></i></div>
          <span class="contact-label">Instagram</span>
          <span class="contact-value">@dhathrendra08</span>
        </a>

        <a
          href="https://in.linkedin.com/in/dhathrendra"
          class="contact-card"
          target="_blank"
        >
          <div class="icon-wrapper"><i class="fab fa-linkedin-in"></i></div>
          <span class="contact-label">LinkedIn</span>
          <span class="contact-value">dhathrendra</span>
        </a>

        <a
          href="https://github.com/dhathrendra"
          class="contact-card"
          target="_blank"
        >
          <div class="icon-wrapper"><i class="fab fa-github"></i></div>
          <span class="contact-label">GitHub</span>
          <span class="contact-value">dhathrendra</span>
        </a>
      </div>
    </section>

    <section id="location" class="location-page">
      <h2 class="section-title">How's Hyderabad?</h2>

      <div class="split-container">
        <div class="map-card">
          <div id="map"></div>
          <div class="map-label">Golconda Fort, Hyderabad</div>
        </div>

        <div class="weather-card">
          <div class="weather-icon">
            <img id="weather-img" src="" alt="Weather" />
          </div>
          <div class="weather-info">
            <h3 id="temp">--°C</h3>
            <p id="condition">Loading...</p>
            <div class="weather-details">
              <p><i class="fas fa-wind"></i> <span id="wind">-- km/h</span></p>
              <p><i class="fas fa-tint"></i> <span id="humidity">--%</span></p>
              <p>
                <i class="fas fa-thermometer-half"></i> Feels like
                <span id="feels">--°C</span>
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <script>
      const API_URL = "https://portfolio-api-pjzq.onrender.com/api";

      fetch(`${API_URL}/about`)
        .then((response) => {
          if (!response.ok) throw new Error("API not reachable");
          return response.json();
        })
        .then((data) => {
          let paragraphs = data.about
            .split("\n\n")
            .map((p) => p.trim())
            .filter((p) => p.length > 0);

          let html = paragraphs
            .map(
              (para, index, array) =>
                `<p>${para.replace(/\n/g, "<br>")}</p>` +
                (index < array.length - 1 ? "<br>" : "")
            )
            .join("");

          const highlights = [
            "Dhathrendra",
            "Dhath",
            "IIT Madras",
            "neuroscience",
            "psychology",
            "biology",
            "programming",
            "Shaastra",
            "CFI clubs",
            "Hyderabad",
            "biryani",
            "music",
            "movies",
            "anime",
            "debating society",
          ];

          highlights.forEach((word) => {
            const regex = new RegExp(`(${word})`, "gi");
            html = html.replace(regex, '<span class="highlight">$1</span>');
          });

          document.getElementById("about-text").innerHTML = html;
        })
        .catch((err) => {
          console.error(err);
          document.getElementById("about-text").innerHTML =
            "<p style='color:#ff3366'>Failed to load About section (check console)</p>";
        });

      fetch(`${API_URL}/education`)
        .then((r) => r.json())
        .then((edu) => {
          fetch(`${API_URL}/experience`)
            .then((r) => r.json())
            .then((exp) => {
              const container = document.getElementById("timeline-container");
              container.innerHTML = "";
              edu.forEach((item) => {
                container.innerHTML += `
            <div class="timeline-block">
              <div class="timeline-icon education">
                <i class="fas fa-graduation-cap"></i>
              </div>
              <div class="timeline-content">
                <h3>${item.degree}</h3>
                <p class="org">${item.institute}</p>
                <p class="date">${item.years}</p>
              </div>
            </div>`;
              });

              exp.forEach((item) => {
                let iconClass = "fa-briefcase";
                let wrapperClass = "";

                if (item.org.includes("Biotech"))
                  (wrapperClass = "biotech"), (iconClass = "fa-dna");
                else if (item.org.includes("Horizon"))
                  (wrapperClass = "horizon"), (iconClass = "fa-satellite-dish");
                else if (
                  item.org.includes("WebOps") ||
                  item.org.includes("Blockchain")
                ) {
                  wrapperClass = "blockchain";
                  iconClass = "fa-code";
                } else if (item.org.includes("Biogen"))
                  (wrapperClass = "volunteer"), (iconClass = "fa-leaf");
                else if (
                  item.org.includes("Debate") ||
                  item.org.includes("Oratory")
                ) {
                  (wrapperClass = "debate"), (iconClass = "fa-microphone-alt");
                }

                container.innerHTML += `
            <div class="timeline-block">
              <div class="timeline-icon ${wrapperClass}">
                <i class="fas ${iconClass}"></i>
              </div>
              <div class="timeline-content">
                <h3>${item.role}</h3>
                <p class="org">${item.org}</p>
                <p class="date">${item.date}</p>
              </div>
            </div>`;
              });
            });
        })
        .catch(() => {
          document.getElementById("timeline-container").innerHTML =
            "<p style='color:#ff3366'>Failed to load Journey</p>";
        });

      const hamburger = document.querySelector(".hamburger");
      const mobileMenu = document.querySelector(".mobile-menu");

      hamburger.addEventListener("click", () => {
        hamburger.classList.toggle("active");
        mobileMenu.classList.toggle("active");
      });

      document.querySelectorAll(".mobile-menu a").forEach((link) => {
        link.addEventListener("click", () => {
          hamburger.classList.remove("active");
          mobileMenu.classList.remove("active");
        });
      });
    </script>

    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
      const map = L.map("map").setView([17.3873294, 78.4057336], 16);
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution: "© OpenStreetMap",
      }).addTo(map);

      L.marker([17.3873294, 78.4057336])
        .addTo(map)
        .bindPopup("<b>Golconda Fort</b><br>Hyderabad, India")
        .openPopup();

      fetch(
        "https://api.weatherapi.com/v1/current.json?key=2a43970391d248a1a3621129250312&q=17.3873294,78.4057336"
      )
        .then((r) => r.json())
        .then((data) => {
          document.getElementById("temp").textContent =
            data.current.temp_c + "°C";
          document.getElementById("condition").textContent =
            data.current.condition.text;
          document.getElementById("weather-img").src =
            "https:" + data.current.condition.icon;
          document.getElementById("wind").textContent =
            data.current.wind_kph + " km/h";
          document.getElementById("humidity").textContent =
            data.current.humidity + "%";
          document.getElementById("feels").textContent =
            data.current.feelslike_c + "°C";
        })
        .catch(() => {
          document.getElementById("condition").textContent =
            "Weather unavailable";
        });
    </script>

    <footer class="site-footer">
      <p>Made with <i class="fas fa-heart" style="color: #ff3366"></i></p>
    </footer>

    <style>
      .site-footer {
        text-align: center;
        padding: 40px 20px;
        color: #555;
        font-size: 0.9rem;
        background: rgba(0, 0, 0, 0.8);
      }
      .site-footer i {
        animation: pulse 2s infinite;
      }
      @keyframes pulse {
        0%,
        100% {
          opacity: 0.3;
        }
        50% {
          opacity: 1;
        }
      }
    </style>
  </body>
</html>
